<div class="img-container">
  <!--Header-->
  <app-header [isWhiteLogo]="true"></app-header>

  <!--Content-->
  <div class="container">
    <!--Principal title-->
    <div class="row">
      <div class="col-12 col-center">
        <h1 class="principal-title">Carta</h1>
      </div>
    </div>

    <!--Business info-->
    <mat-card>
      <div class="row pl-3 justify-content-center">
        <div class="col-lg-5">
          <p class="title">{{ restaurant?.name }}</p>
        </div>
        <div class="col-lg-3">
          <p class="titulo-4">Rango de Precios:</p>
          <p class="money">$$$$$</p>
        </div>
        <div class="col-lg-4">
          <p class="titulo-4">Chefcitos:</p>
          <img
            src="../../../assets/icons/frying-pan-2.svg"
            *ngFor="let z of ratingsArray"
          />
          <img
            src="../../../assets/icons/frying-pan-1.svg"
            *ngFor="let z of noRatingsArray"
          />
        </div>
      </div>
    </mat-card>

    <br /><br />

    <!--Add section button-->
    <form
      [formGroup]="form"
      (ngSubmit)="saveChanges()"
      (keydown.enter)="$event.preventDefault()"
    >
      <ng-container formArrayName="sections">
        <mat-accordion>
          <mat-expansion-panel
            *ngFor="let section of sections.controls; let i = index"
            hideToggle="true"
            #toggleIcon
          >
            <mat-expansion-panel-header
              class="panel-header"
              [formGroup]="section"
            >
              <mat-panel-title>
                <label class="section-title mx-0 mx-lg-5">
                  {{ section.get("title").value | uppercase }}
                </label>
              </mat-panel-title>

              <mat-panel-description class="title-icon-toggle">
                <mat-icon *ngIf="!toggleIcon.expanded" class="toggleIcon"
                  >expand_more</mat-icon
                >
                <mat-icon *ngIf="toggleIcon.expanded" class="toggleIcon"
                  >expand_less</mat-icon
                >
              </mat-panel-description>
            </mat-expansion-panel-header>

            <!--Section Content-->
            <mat-accordion>
              <ng-container>
                <div class="container px-0">
                  <div
                    *ngFor="
                      let product of products(section);
                      let p = index;
                      let length = count
                    "
                    class="pb-4 wrap-product"
                  >
                    <ng-container [formGroup]="product">
                      <div class="row mx-0 mx-lg-5">
                        <div class="col-md-12 col-lg-6 px-0">
                          <p class="parrafo">
                            {{ product.get("name").value }}
                          </p>
                        </div>
                      </div>

                      <div class="row mx-0 mx-lg-5">
                        <div
                          class="
                            col-md-12 col-lg-3
                            px-0
                            pr-lg-4
                            mb-3 mb-lg-0
                            col-center
                          "
                        >
                          <img
                            class="img-responsive border-rounded product-h-img"
                            [src]="product.get('imageUrl').value"
                          />
                        </div>

                        <div class="col-md-11 col-lg-4">
                          <p class="parrafo">
                            {{ product.get("description").value }}
                          </p>
                        </div>

                        <div class="col-5 col-md-6 col-lg-2 col-price">
                          <p class="parrafo">
                            $ {{ product.get("price").value }} c/u
                          </p>
                        </div>

                        <div class="col col-add-remove">
                          <mat-icon
                            class="add-remove-item-icon"
                            (click)="deleteProduct(product)"
                            >remove_circle_outline
                          </mat-icon>
                          <label class="quantity-item">{{
                            product.get("quantity").value
                          }}</label>
                          <mat-icon
                            class="add-remove-item-icon"
                            (click)="addProduct(product)"
                            >add_circle_outline
                          </mat-icon>
                        </div>
                      </div>
                    </ng-container>

                    <mat-divider *ngIf="p != length - 1"></mat-divider>
                  </div>
                </div>
              </ng-container>
            </mat-accordion>
          </mat-expansion-panel>

          <mat-expansion-panel hideToggle="true" class="panel-total">
            <mat-expansion-panel-header>
              <mat-panel-title> </mat-panel-title>
              <mat-panel-description class="panel-description">
                <label class="section-title mx-0 mx-lg-5">TOTAL</label>
                <label class="section-title mx-0 mx-lg-5"
                  >$ {{ (total | number).replace(",", ".") }}</label
                >
              </mat-panel-description>
            </mat-expansion-panel-header>
          </mat-expansion-panel>
        </mat-accordion>
      </ng-container>

      <br /><br />

      <div class="row">
        <div class="col col-center">
          <button
            type="submit"
            class="btn-submit"
            mat-raised-button
            (click)="openReservationModal()"
          >
            Reservar
          </button>
          <p class="p-message">Se abrir√° una ventana emergente</p>
        </div>
      </div>
    </form>
  </div>

  <!--Footer-->
  <app-footer></app-footer>
</div>
